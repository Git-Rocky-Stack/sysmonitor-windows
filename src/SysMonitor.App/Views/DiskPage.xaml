<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SysMonitor.App.Views.DiskPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:viewmodels="using:SysMonitor.App.ViewModels"
    Background="{StaticResource BackgroundBrush}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Padding="0,0,0,24" Spacing="16">

            <!-- Page Header Banner -->
            <Border Style="{StaticResource HeaderBannerStyle}">
                <StackPanel HorizontalAlignment="Center" Spacing="8">
                    <FontIcon Glyph="&#xEDA2;" FontSize="48" Foreground="{StaticResource TextPrimaryBrush}"/>
                    <TextBlock Text="DISK ANALYZER" Style="{StaticResource PageHeaderStyle}"
                               Foreground="{StaticResource TextPrimaryBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Storage space and drive analytics" Style="{StaticResource PageSubtitleStyle}"
                               Foreground="#AAFFFFFF" HorizontalAlignment="Center" Margin="0"/>
                </StackPanel>
            </Border>

            <!-- Loading State -->
            <Border Style="{StaticResource CardStyle}" Padding="32"
                    Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <StackPanel HorizontalAlignment="Center" Spacing="16">
                    <ProgressRing IsActive="True" Width="48" Height="48"/>
                    <TextBlock Text="Analyzing drives..." Style="{StaticResource CardSubtitleStyle}"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Total Storage Overview Section -->
            <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}"
                        Visibility="{x:Bind ViewModel.HasDisks, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                <TextBlock Text="STORAGE OVERVIEW" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
            </StackPanel>

            <!-- Total Storage Card -->
            <Border Style="{StaticResource CardStyle}" Padding="24"
                    Visibility="{x:Bind ViewModel.HasDisks, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <Grid RowSpacing="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Header with Icon -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                            <Border Style="{StaticResource IconContainerStyle}" Background="{StaticResource PrimaryBrush}"
                                    Width="56" Height="56">
                                <FontIcon Glyph="&#xE8B7;" FontSize="28" Foreground="{StaticResource TextPrimaryBrush}"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="TOTAL STORAGE" Style="{StaticResource StatLabelStyle}" FontSize="14"/>
                                <TextBlock Foreground="{StaticResource TextPrimaryBrush}" FontWeight="Bold" FontSize="28">
                                    <Run Text="{x:Bind ViewModel.TotalStorageGB, Mode=OneWay, Converter={StaticResource GBConverter}}"/>
                                    <Run Text="GB" FontWeight="Normal" FontSize="16"/>
                                </TextBlock>
                            </StackPanel>
                        </StackPanel>

                        <!-- Status Badge -->
                        <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <Ellipse Width="10" Height="10" VerticalAlignment="Center">
                                    <Ellipse.Fill>
                                        <SolidColorBrush Color="{x:Bind ViewModel.TotalStorageColor, Mode=OneWay}"/>
                                    </Ellipse.Fill>
                                </Ellipse>
                                <TextBlock FontSize="13" FontWeight="SemiBold">
                                    <TextBlock.Foreground>
                                        <SolidColorBrush Color="{x:Bind ViewModel.TotalStorageColor, Mode=OneWay}"/>
                                    </TextBlock.Foreground>
                                    <Run Text="{x:Bind ViewModel.TotalStorageStatus, Mode=OneWay}"/>
                                </TextBlock>
                            </StackPanel>
                        </StackPanel>
                    </Grid>

                    <!-- Progress Bar -->
                    <Grid Grid.Row="1">
                        <ProgressBar Value="{x:Bind ViewModel.TotalUsagePercent, Mode=OneWay}"
                                     Maximum="100" Height="12" CornerRadius="6"
                                     Background="{StaticResource SurfaceLightBrush}"
                                     Foreground="{StaticResource PrimaryBrush}"/>
                    </Grid>

                    <!-- Stats Row -->
                    <Grid Grid.Row="2" ColumnSpacing="24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Used Space -->
                        <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                            <TextBlock Text="USED" Style="{StaticResource StatLabelStyle}" HorizontalAlignment="Center"/>
                            <TextBlock HorizontalAlignment="Center" Foreground="{StaticResource PrimaryBrush}"
                                       FontWeight="SemiBold" FontSize="18">
                                <Run Text="{x:Bind ViewModel.TotalUsedGB, Mode=OneWay, Converter={StaticResource GBConverter}}"/>
                                <Run Text="GB" FontSize="12"/>
                            </TextBlock>
                        </StackPanel>

                        <!-- Free Space -->
                        <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                            <TextBlock Text="FREE" Style="{StaticResource StatLabelStyle}" HorizontalAlignment="Center"/>
                            <TextBlock HorizontalAlignment="Center" Foreground="{StaticResource SuccessBrush}"
                                       FontWeight="SemiBold" FontSize="18">
                                <Run Text="{x:Bind ViewModel.TotalFreeGB, Mode=OneWay, Converter={StaticResource GBConverter}}"/>
                                <Run Text="GB" FontSize="12"/>
                            </TextBlock>
                        </StackPanel>

                        <!-- Usage Percent -->
                        <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                            <TextBlock Text="USAGE" Style="{StaticResource StatLabelStyle}" HorizontalAlignment="Center"/>
                            <TextBlock HorizontalAlignment="Center" Foreground="{StaticResource CyanAccentBrush}"
                                       FontWeight="SemiBold" FontSize="18">
                                <Run Text="{x:Bind ViewModel.TotalUsagePercent, Mode=OneWay, Converter={StaticResource PercentConverter}}"/>
                                <Run Text="%" FontSize="12"/>
                            </TextBlock>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>

            <!-- Drives Section -->
            <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}" Margin="0,8,0,0"
                        Visibility="{x:Bind ViewModel.HasDisks, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                <TextBlock Text="DRIVES" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
            </StackPanel>

            <!-- Drives List -->
            <ItemsRepeater ItemsSource="{x:Bind ViewModel.Disks, Mode=OneWay}">
                <ItemsRepeater.Layout>
                    <StackLayout Orientation="Vertical" Spacing="12"/>
                </ItemsRepeater.Layout>
                <ItemsRepeater.ItemTemplate>
                    <DataTemplate x:DataType="viewmodels:DiskDisplayInfo">
                        <Border Style="{StaticResource CardStyle}" Padding="20">
                            <Grid RowSpacing="16">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Drive Header -->
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Drive Icon -->
                                    <Border Grid.Column="0" Width="48" Height="48" CornerRadius="10"
                                            Background="{StaticResource SurfaceLightBrush}">
                                        <FontIcon Glyph="{x:Bind DriveIcon}" FontSize="24"
                                                  Foreground="{StaticResource TextPrimaryBrush}"/>
                                    </Border>

                                    <!-- Drive Info -->
                                    <StackPanel Grid.Column="1" Margin="16,0,0,0" VerticalAlignment="Center">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <TextBlock Text="{x:Bind Name}" Style="{StaticResource MenuItemTextStyle}"
                                                       FontSize="18" FontWeight="Bold"/>
                                            <TextBlock Text="{x:Bind Label}" Style="{StaticResource CardSubtitleStyle}"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,4,0,0">
                                            <TextBlock Style="{StaticResource CardSubtitleStyle}">
                                                <Run Text="{x:Bind FileSystem}"/>
                                            </TextBlock>
                                            <TextBlock Text="|" Style="{StaticResource CardSubtitleStyle}"/>
                                            <TextBlock Style="{StaticResource CardSubtitleStyle}">
                                                <Run Text="{x:Bind DriveType}"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </StackPanel>

                                    <!-- Status and Type Badges -->
                                    <StackPanel Grid.Column="2" Spacing="8" VerticalAlignment="Center">
                                        <!-- Status Badge -->
                                        <Border CornerRadius="8" Padding="10,4">
                                            <Border.Background>
                                                <SolidColorBrush Color="{x:Bind UsageColor}" Opacity="0.2"/>
                                            </Border.Background>
                                            <StackPanel Orientation="Horizontal" Spacing="6">
                                                <Ellipse Width="8" Height="8" VerticalAlignment="Center">
                                                    <Ellipse.Fill>
                                                        <SolidColorBrush Color="{x:Bind UsageColor}"/>
                                                    </Ellipse.Fill>
                                                </Ellipse>
                                                <TextBlock Text="{x:Bind UsageStatus}" FontWeight="SemiBold" FontSize="11">
                                                    <TextBlock.Foreground>
                                                        <SolidColorBrush Color="{x:Bind UsageColor}"/>
                                                    </TextBlock.Foreground>
                                                </TextBlock>
                                            </StackPanel>
                                        </Border>
                                        <!-- Storage Type Badge -->
                                        <Border CornerRadius="8" Padding="12,4"
                                                Background="{StaticResource SurfaceLightBrush}"
                                                HorizontalAlignment="Right">
                                            <TextBlock Text="{x:Bind StorageType}" FontWeight="SemiBold" FontSize="11"
                                                       Foreground="{StaticResource CyanAccentBrush}"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>

                                <!-- Progress Bar with Percentage -->
                                <Grid Grid.Row="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <ProgressBar Grid.Column="0" Value="{x:Bind UsagePercent}"
                                                 Maximum="100" Height="10" CornerRadius="5"
                                                 Background="{StaticResource SurfaceLightBrush}"
                                                 Margin="0,0,16,0">
                                        <ProgressBar.Foreground>
                                            <SolidColorBrush Color="{x:Bind UsageColor}"/>
                                        </ProgressBar.Foreground>
                                    </ProgressBar>

                                    <TextBlock Grid.Column="1" FontWeight="Bold" FontSize="14"
                                               VerticalAlignment="Center">
                                        <TextBlock.Foreground>
                                            <SolidColorBrush Color="{x:Bind UsageColor}"/>
                                        </TextBlock.Foreground>
                                        <Run Text="{x:Bind FormattedPercent}"/>
                                    </TextBlock>
                                </Grid>

                                <!-- Storage Details -->
                                <Grid Grid.Row="2" ColumnSpacing="16">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Used -->
                                    <Border Grid.Column="0" Background="{StaticResource SurfaceLightBrush}"
                                            CornerRadius="8" Padding="12,8">
                                        <StackPanel>
                                            <TextBlock Text="USED" Style="{StaticResource StatLabelStyle}"
                                                       HorizontalAlignment="Center" FontSize="10"/>
                                            <TextBlock Text="{x:Bind FormattedUsed}" HorizontalAlignment="Center"
                                                       FontWeight="SemiBold">
                                                <TextBlock.Foreground>
                                                    <SolidColorBrush Color="{x:Bind UsageColor}"/>
                                                </TextBlock.Foreground>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>

                                    <!-- Free -->
                                    <Border Grid.Column="1" Background="{StaticResource SurfaceLightBrush}"
                                            CornerRadius="8" Padding="12,8">
                                        <StackPanel>
                                            <TextBlock Text="FREE" Style="{StaticResource StatLabelStyle}"
                                                       HorizontalAlignment="Center" FontSize="10"/>
                                            <TextBlock Text="{x:Bind FormattedFree}" HorizontalAlignment="Center"
                                                       Foreground="{StaticResource SuccessBrush}"
                                                       FontWeight="SemiBold"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Total -->
                                    <Border Grid.Column="2" Background="{StaticResource SurfaceLightBrush}"
                                            CornerRadius="8" Padding="12,8">
                                        <StackPanel>
                                            <TextBlock Text="TOTAL" Style="{StaticResource StatLabelStyle}"
                                                       HorizontalAlignment="Center" FontSize="10"/>
                                            <TextBlock Text="{x:Bind FormattedTotal}" HorizontalAlignment="Center"
                                                       Foreground="{StaticResource TextPrimaryBrush}"
                                                       FontWeight="SemiBold"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>

            <!-- Storage Tips Section -->
            <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}" Margin="0,8,0,0"
                        Visibility="{x:Bind ViewModel.HasDisks, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                <TextBlock Text="STORAGE TIPS" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
            </StackPanel>

            <Border Style="{StaticResource CardStyle}" Padding="20"
                    Visibility="{x:Bind ViewModel.HasDisks, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">
                <StackPanel Spacing="12">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <FontIcon Glyph="&#xE8C8;" Foreground="{StaticResource CyanAccentBrush}" FontSize="18"/>
                        <TextBlock Text="Keep at least 10-15% of each drive free for optimal performance"
                                   Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <FontIcon Glyph="&#xE74D;" Foreground="{StaticResource CyanAccentBrush}" FontSize="18"/>
                        <TextBlock Text="Use the Cleaner tool to remove temporary and cache files"
                                   Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <FontIcon Glyph="&#xE8B7;" Foreground="{StaticResource CyanAccentBrush}" FontSize="18"/>
                        <TextBlock Text="Consider using an SSD for your operating system for faster boot times"
                                   Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Footer -->
            <StackPanel HorizontalAlignment="Center" Spacing="8" Margin="0,16,0,0">
                <Image Source="ms-appx:///Assets/Header_Main1.png"
                       Height="16" HorizontalAlignment="Center"
                       Stretch="Uniform" Opacity="0.7"/>
                <TextBlock Text="Powered by Strategia-X Technology"
                           HorizontalAlignment="Center"
                           Foreground="{StaticResource PrimaryBrush}"
                           FontSize="12"/>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</Page>
