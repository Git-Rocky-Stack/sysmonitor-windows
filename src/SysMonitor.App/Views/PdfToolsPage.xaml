<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SysMonitor.App.Views.PdfToolsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SysMonitor.App.Views"
    xmlns:vm="using:SysMonitor.App.ViewModels"
    x:Name="ContentArea"
    Background="{StaticResource BackgroundBrush}">

    <Grid RowSpacing="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Page Header Banner -->
        <Border Grid.Row="0" Background="#000000" Padding="24" Margin="-24,-24,-24,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left: Header text -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center" Spacing="4">
                    <TextBlock Text="PDF TOOLS" Style="{StaticResource PageHeaderStyle}"
                               Foreground="{StaticResource PrimaryBrush}" HorizontalAlignment="Left"/>
                    <TextBlock Text="Merge, Split, Extract, Sign &amp; Convert Files to PDF" Style="{StaticResource PageSubtitleStyle}"
                               Foreground="#AAFFFFFF" HorizontalAlignment="Left" Margin="0"/>
                </StackPanel>

                <!-- Center: STX.1 Home Logo -->
                <Image Grid.Column="1" Source="ms-appx:///Assets/Home_Logo.png"
                       Height="80" VerticalAlignment="Center" HorizontalAlignment="Center"
                       Stretch="Uniform"/>
            </Grid>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Spacing="16" Padding="0,16,0,24">

                <!-- Mode Selection Section -->
                <StackPanel Spacing="12">
                    <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}">
                        <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                        <TextBlock Text="SELECT OPERATION" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                                <RadioButton Content="Merge PDFs" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsMergeMode, Mode=TwoWay}"
                                             Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Merge"/>
                                <RadioButton Content="Split PDF" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsSplitMode, Mode=TwoWay}"
                                             Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Split"/>
                                <RadioButton Content="Extract Pages" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsExtractMode, Mode=TwoWay}"
                                             Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Extract"/>
                                <RadioButton Content="Add Signature" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsSignatureMode, Mode=TwoWay}"
                                             Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Signature"/>
                                <RadioButton Content="Convert to PDF" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsConvertMode, Mode=TwoWay}"
                                             Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Convert"/>
                            </StackPanel>
                            <Button Grid.Column="1" Click="OpenPdfEditor_Click" Style="{StaticResource RedButtonStyle}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE70F;" FontSize="14"/>
                                    <TextBlock Text="EDIT PDF"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>
                </StackPanel>

                <!-- Merge Mode -->
                <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsMergeMode, Mode=OneWay}">
                    <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}">
                        <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                        <TextBlock Text="MERGE PDFs" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0" Style="{StaticResource IconContainerStyle}" Margin="0,0,16,0">
                                    <FontIcon Glyph="&#xE8BB;" FontSize="20" Foreground="{StaticResource TextPrimaryBrush}"/>
                                </Border>

                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="PDFs to Merge" Style="{StaticResource CardTitleStyle}"/>
                                    <TextBlock Text="Select multiple PDF files to combine into one" Style="{StaticResource CardSubtitleStyle}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="8">
                                    <Button Command="{x:Bind ViewModel.SelectMultiplePdfsCommand}" Style="{StaticResource OutlinedButtonStyle}">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE710;" FontSize="14"/>
                                            <TextBlock Text="ADD PDFs"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Command="{x:Bind ViewModel.ClearFilesCommand}" Style="{StaticResource OutlinedButtonStyle}">
                                        <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <ListView ItemsSource="{x:Bind ViewModel.SelectedFiles, Mode=OneWay}" MinHeight="120"
                                      Background="Transparent" SelectionMode="None">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Margin" Value="0,2"/>
                                        <Setter Property="Padding" Value="0"/>
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.ItemTemplate>
                                    <DataTemplate x:DataType="vm:PdfFileDisplay">
                                        <Border Style="{StaticResource CardStyle}" Padding="12">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <FontIcon Glyph="&#xEA90;" Foreground="{StaticResource PrimaryBrush}" FontSize="24" VerticalAlignment="Center"/>

                                                <StackPanel Grid.Column="1" Margin="12,0" VerticalAlignment="Center">
                                                    <TextBlock Text="{x:Bind FileName}" Style="{StaticResource CardTitleStyle}"/>
                                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                                        <TextBlock Text="{x:Bind PageCount}" Style="{StaticResource CardSubtitleStyle}"/>
                                                        <TextBlock Text="pages" Style="{StaticResource CardSubtitleStyle}"/>
                                                        <TextBlock Text="-" Style="{StaticResource CardSubtitleStyle}"/>
                                                        <TextBlock Text="{x:Bind FileSize}" Style="{StaticResource CardSubtitleStyle}"/>
                                                    </StackPanel>
                                                </StackPanel>

                                                <Button Grid.Column="2" Command="{Binding DataContext.MoveFileUpCommand, ElementName=ContentArea}"
                                                        CommandParameter="{x:Bind}" Padding="8" Background="Transparent">
                                                    <FontIcon Glyph="&#xE74A;" FontSize="12"/>
                                                </Button>
                                                <Button Grid.Column="3" Command="{Binding DataContext.RemoveFileCommand, ElementName=ContentArea}"
                                                        CommandParameter="{x:Bind}" Padding="8" Background="Transparent">
                                                    <FontIcon Glyph="&#xE711;" FontSize="12"/>
                                                </Button>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>

                            <Button Command="{x:Bind ViewModel.MergePdfsCommand}" Style="{StaticResource RedButtonStyle}"
                                    HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.IsProcessing, Mode=OneWay, Converter={StaticResource InvertBoolConverter}}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE8BB;" FontSize="14"/>
                                    <TextBlock Text="MERGE PDFs"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Split/Extract/Signature/Convert Mode - File Selection -->
                <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsMergeMode, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}">
                    <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}"
                                Visibility="{x:Bind ViewModel.IsConvertMode, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}">
                        <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                        <TextBlock Text="SELECT PDF FILE" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}"
                            Visibility="{x:Bind ViewModel.IsConvertMode, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}">
                        <StackPanel Spacing="16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0" Style="{StaticResource IconContainerStyle}" Margin="0,0,16,0">
                                    <FontIcon Glyph="&#xEA90;" FontSize="20" Foreground="{StaticResource PrimaryBrush}"/>
                                </Border>

                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="{x:Bind ViewModel.SelectedPdfName, Mode=OneWay}" Style="{StaticResource CardTitleStyle}"
                                               Visibility="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}"/>
                                    <TextBlock Text="No PDF selected" Style="{StaticResource CardTitleStyle}"
                                               Visibility="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}"/>
                                    <StackPanel Orientation="Horizontal" Spacing="16" Visibility="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                                        <TextBlock Style="{StaticResource CardSubtitleStyle}">
                                            <Run Text="{x:Bind ViewModel.PageCount, Mode=OneWay}"/> pages
                                        </TextBlock>
                                        <TextBlock Text="{x:Bind ViewModel.FileSize, Mode=OneWay}" Style="{StaticResource CardSubtitleStyle}"/>
                                        <TextBlock Text="{x:Bind ViewModel.PdfVersion, Mode=OneWay}" Style="{StaticResource CardSubtitleStyle}"/>
                                    </StackPanel>
                                    <TextBlock Text="Click Browse to select a PDF file" Style="{StaticResource CardSubtitleStyle}"
                                               Visibility="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}"/>
                                </StackPanel>

                                <Button Grid.Column="2" Command="{x:Bind ViewModel.SelectPdfCommand}" Style="{StaticResource OutlinedButtonStyle}">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8E5;" FontSize="14"/>
                                        <TextBlock Text="BROWSE"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Split Options -->
                <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsSplitMode, Mode=OneWay}">
                    <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}">
                        <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                        <TextBlock Text="SPLIT OPTIONS" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <RadioButton Content="Split into individual pages" IsChecked="{x:Bind ViewModel.SplitAllPages, Mode=TwoWay}"/>
                            <RadioButton Content="Split by page range" IsChecked="{x:Bind ViewModel.SplitByRange, Mode=TwoWay}"/>

                            <Grid Visibility="{x:Bind ViewModel.SplitByRange, Mode=OneWay}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="From page:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}"/>
                                <NumberBox Grid.Column="1" Value="{x:Bind ViewModel.SplitStartPage, Mode=TwoWay}" Minimum="1"
                                           Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                                <TextBlock Grid.Column="2" Text="To page:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}" Margin="16,0,0,0"/>
                                <NumberBox Grid.Column="3" Value="{x:Bind ViewModel.SplitEndPage, Mode=TwoWay}" Minimum="1"
                                           Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                            </Grid>

                            <Button Command="{x:Bind ViewModel.SplitPdfCommand}" Style="{StaticResource RedButtonStyle}"
                                    HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE8C8;" FontSize="14"/>
                                    <TextBlock Text="SPLIT PDF"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Extract Options -->
                <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsExtractMode, Mode=OneWay}">
                    <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}">
                        <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                        <TextBlock Text="EXTRACT PAGES" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="From page:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}"/>
                                <NumberBox Grid.Column="1" Value="{x:Bind ViewModel.ExtractStartPage, Mode=TwoWay}" Minimum="1"
                                           Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                                <TextBlock Grid.Column="2" Text="To page:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}" Margin="16,0,0,0"/>
                                <NumberBox Grid.Column="3" Value="{x:Bind ViewModel.ExtractEndPage, Mode=TwoWay}" Minimum="1"
                                           Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                            </Grid>

                            <Button Command="{x:Bind ViewModel.ExtractPagesCommand}" Style="{StaticResource RedButtonStyle}"
                                    HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE8A7;" FontSize="14"/>
                                    <TextBlock Text="EXTRACT PAGES"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Signature Options -->
                <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsSignatureMode, Mode=OneWay}">
                    <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}">
                        <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                        <TextBlock Text="ADD SIGNATURE" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <!-- Signature Type Selection -->
                            <StackPanel Orientation="Horizontal" Spacing="16">
                                <RadioButton Content="Draw Signature" GroupName="SignatureType"
                                             IsChecked="{x:Bind ViewModel.IsDrawSignature, Mode=TwoWay}"/>
                                <RadioButton Content="Type Signature" GroupName="SignatureType"
                                             IsChecked="{x:Bind ViewModel.IsTypeSignature, Mode=TwoWay}"/>
                                <RadioButton Content="Upload Image" GroupName="SignatureType"
                                             IsChecked="{x:Bind ViewModel.IsUploadSignature, Mode=TwoWay}"/>
                            </StackPanel>

                            <!-- Draw Signature Canvas -->
                            <StackPanel Spacing="8" Visibility="{x:Bind ViewModel.IsDrawSignature, Mode=OneWay}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Draw your signature below" Style="{StaticResource CardSubtitleStyle}"/>
                                    <Button Grid.Column="1" Click="ClearInkCanvas_Click" Style="{StaticResource OutlinedButtonStyle}">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <FontIcon Glyph="&#xE74D;" FontSize="12"/>
                                            <TextBlock Text="CLEAR"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                                <Border Background="White" CornerRadius="8" Height="150" BorderBrush="{StaticResource DividerBrush}" BorderThickness="1">
                                    <Canvas x:Name="SignatureCanvas"
                                            Background="White"
                                            PointerPressed="SignatureCanvas_PointerPressed"
                                            PointerMoved="SignatureCanvas_PointerMoved"
                                            PointerReleased="SignatureCanvas_PointerReleased"
                                            PointerExited="SignatureCanvas_PointerReleased"/>
                                </Border>
                                <TextBlock Text="Use mouse or touch to draw" Style="{StaticResource CardSubtitleStyle}" FontStyle="Italic"/>
                            </StackPanel>

                            <!-- Type Signature (Cursive) -->
                            <StackPanel Spacing="8" Visibility="{x:Bind ViewModel.IsTypeSignature, Mode=OneWay}">
                                <TextBlock Text="Type your name below (will appear in cursive style)" Style="{StaticResource CardSubtitleStyle}"/>
                                <TextBox x:Name="TypedSignatureInput"
                                         Text="{x:Bind ViewModel.TypedSignatureName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PlaceholderText="Type your full name..."
                                         Style="{StaticResource SearchTextBoxStyle}"
                                         TextChanged="TypedSignatureInput_TextChanged"/>
                                <Border Background="White" CornerRadius="8" Height="80" BorderBrush="{StaticResource DividerBrush}" BorderThickness="1" Padding="16,8">
                                    <TextBlock x:Name="TypedSignaturePreview"
                                               Text="{x:Bind ViewModel.TypedSignatureName, Mode=OneWay}"
                                               FontFamily="Segoe Script"
                                               FontSize="32"
                                               Foreground="Black"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Left"/>
                                </Border>
                                <TextBlock Text="Preview of your signature in cursive style" Style="{StaticResource CardSubtitleStyle}" FontStyle="Italic"/>
                            </StackPanel>

                            <!-- Upload Signature Image -->
                            <StackPanel Spacing="8" Visibility="{x:Bind ViewModel.IsUploadSignature, Mode=OneWay}">
                                <TextBlock Text="Signature Image" Style="{StaticResource CardSubtitleStyle}"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Style="{StaticResource CardStyle}" Padding="12,8" VerticalAlignment="Center">
                                        <TextBlock Text="{x:Bind ViewModel.SignatureImageName, Mode=OneWay}" Style="{StaticResource CardSubtitleStyle}"/>
                                    </Border>
                                    <Button Grid.Column="1" Command="{x:Bind ViewModel.SelectSignatureImageCommand}" Style="{StaticResource OutlinedButtonStyle}" Margin="8,0">
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="&#xE8B9;" FontSize="14"/>
                                            <TextBlock Text="BROWSE"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Grid.Column="2" Command="{x:Bind ViewModel.ClearSignatureImageCommand}" Style="{StaticResource OutlinedButtonStyle}"
                                            Visibility="{x:Bind ViewModel.HasSignatureImage, Mode=OneWay}">
                                        <FontIcon Glyph="&#xE711;" FontSize="14"/>
                                    </Button>
                                </Grid>
                            </StackPanel>

                            <!-- Signer Name -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="Signer Name" Style="{StaticResource CardSubtitleStyle}"/>
                                <TextBox Text="{x:Bind ViewModel.SignerName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         PlaceholderText="Enter your name (appears below signature)"
                                         Style="{StaticResource SearchTextBoxStyle}"/>
                            </StackPanel>

                            <!-- Include Date -->
                            <CheckBox Content="Include date" IsChecked="{x:Bind ViewModel.IncludeSignatureDate, Mode=TwoWay}"/>

                            <!-- Page Number -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Page:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}"/>
                                <NumberBox Grid.Column="1" Value="{x:Bind ViewModel.SignaturePageNumber, Mode=TwoWay}" Minimum="1"
                                           Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                            </Grid>

                            <!-- Position Controls -->
                            <TextBlock Text="Signature Position" Style="{StaticResource CardSubtitleStyle}" Margin="0,8,0,0"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="50"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="50"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="X:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}"/>
                                <Slider Grid.Column="1" Value="{x:Bind ViewModel.SignatureX, Mode=TwoWay}" Minimum="0" Maximum="100" Margin="8,0"/>
                                <TextBlock Grid.Column="2" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}">
                                    <Run Text="{x:Bind ViewModel.SignatureX, Mode=OneWay}"/><Run Text="%"/>
                                </TextBlock>
                                <TextBlock Grid.Column="3" Text="Y:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}" Margin="16,0,0,0"/>
                                <Slider Grid.Column="4" Value="{x:Bind ViewModel.SignatureY, Mode=TwoWay}" Minimum="0" Maximum="100" Margin="8,0"/>
                                <TextBlock Grid.Column="5" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}">
                                    <Run Text="{x:Bind ViewModel.SignatureY, Mode=OneWay}"/><Run Text="%"/>
                                </TextBlock>
                            </Grid>

                            <!-- Signature Width -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="60"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Width:" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}"/>
                                <Slider Grid.Column="1" Value="{x:Bind ViewModel.SignatureWidth, Mode=TwoWay}" Minimum="50" Maximum="300" Margin="8,0"/>
                                <TextBlock Grid.Column="2" VerticalAlignment="Center" Style="{StaticResource CardSubtitleStyle}">
                                    <Run Text="{x:Bind ViewModel.SignatureWidth, Mode=OneWay}"/><Run Text="pt"/>
                                </TextBlock>
                            </Grid>

                            <Button Command="{x:Bind ViewModel.ApplySignatureCommand}" Style="{StaticResource RedButtonStyle}"
                                    HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xED64;" FontSize="14"/>
                                    <TextBlock Text="APPLY SIGNATURE"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Convert to PDF Mode -->
                <StackPanel Spacing="12" Visibility="{x:Bind ViewModel.IsConvertMode, Mode=OneWay}">
                    <StackPanel Style="{StaticResource SectionHeaderWithAccentStyle}">
                        <Border Style="{StaticResource AccentBarStyle}" Height="20"/>
                        <TextBlock Text="CONVERT TO PDF" Style="{StaticResource SectionHeaderStyle}" Margin="0"/>
                    </StackPanel>

                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel Spacing="16">
                            <!-- Supported formats info -->
                            <Border Background="{StaticResource CardBrush}" CornerRadius="8" Padding="16" BorderBrush="{StaticResource DividerBrush}" BorderThickness="1">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Supported file formats:" Style="{StaticResource CardTitleStyle}"/>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Border Background="#30F44336" CornerRadius="4" Padding="8,4">
                                            <TextBlock Text="Office" FontSize="11" FontWeight="SemiBold" Foreground="{StaticResource PrimaryBrush}"/>
                                        </Border>
                                        <TextBlock Text="DOC, DOCX, XLS, XLSX, PPT, PPTX (requires MS Office)" Style="{StaticResource CardSubtitleStyle}" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Border Background="#304CAF50" CornerRadius="4" Padding="8,4">
                                            <TextBlock Text="Images" FontSize="11" FontWeight="SemiBold" Foreground="#4CAF50"/>
                                        </Border>
                                        <TextBlock Text="JPG, PNG, BMP, GIF, TIFF, WebP" Style="{StaticResource CardSubtitleStyle}" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Border Background="#302196F3" CornerRadius="4" Padding="8,4">
                                            <TextBlock Text="Text" FontSize="11" FontWeight="SemiBold" Foreground="#2196F3"/>
                                        </Border>
                                        <TextBlock Text="TXT, CSV, XML, JSON, MD, HTML" Style="{StaticResource CardSubtitleStyle}" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- File Selection -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0" Style="{StaticResource IconContainerStyle}" Margin="0,0,16,0">
                                    <FontIcon Glyph="&#xE8A5;" FontSize="20" Foreground="{StaticResource TextPrimaryBrush}"
                                              Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}"/>
                                </Border>
                                <Border Grid.Column="0" Style="{StaticResource IconContainerStyle}" Margin="0,0,16,0"
                                        Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}">
                                    <FontIcon Glyph="&#xE8FB;" FontSize="20" Foreground="#4CAF50"/>
                                </Border>

                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="{x:Bind ViewModel.ConvertFileName, Mode=OneWay}" Style="{StaticResource CardTitleStyle}"
                                               Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}"/>
                                    <TextBlock Text="No file selected" Style="{StaticResource CardTitleStyle}"
                                               Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}"/>
                                    <TextBlock Text="{x:Bind ViewModel.ConvertFileType, Mode=OneWay}" Style="{StaticResource CardSubtitleStyle}"
                                               Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}"/>
                                    <TextBlock Text="Click Browse to select a file to convert" Style="{StaticResource CardSubtitleStyle}"
                                               Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}"/>
                                </StackPanel>

                                <Button Grid.Column="2" Command="{x:Bind ViewModel.SelectConvertFileCommand}" Style="{StaticResource OutlinedButtonStyle}" Margin="8,0">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <FontIcon Glyph="&#xE8E5;" FontSize="14"/>
                                        <TextBlock Text="BROWSE"/>
                                    </StackPanel>
                                </Button>
                                <Button Grid.Column="3" Command="{x:Bind ViewModel.ClearConvertFileCommand}" Style="{StaticResource OutlinedButtonStyle}"
                                        Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}">
                                    <FontIcon Glyph="&#xE711;" FontSize="14"/>
                                </Button>
                            </Grid>

                            <Button Command="{x:Bind ViewModel.ConvertToPdfCommand}" Style="{StaticResource RedButtonStyle}"
                                    HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE8AB;" FontSize="14"/>
                                    <TextBlock Text="CONVERT TO PDF"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Processing Status -->
                <Border Style="{StaticResource CardStyle}" Visibility="{x:Bind ViewModel.IsProcessing, Mode=OneWay}">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <ProgressRing IsActive="True" Width="20" Height="20" Foreground="{StaticResource PrimaryBrush}"/>
                        <TextBlock Text="{x:Bind ViewModel.ProcessingStatus, Mode=OneWay}" Style="{StaticResource CardSubtitleStyle}" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Result -->
                <Border Style="{StaticResource CardStyle}" Visibility="{x:Bind ViewModel.HasResult, Mode=OneWay}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Style="{StaticResource IconContainerStyle}" Margin="0,0,16,0">
                            <FontIcon Glyph="&#xE73E;" FontSize="20" Foreground="#4CAF50"/>
                        </Border>

                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Operation Complete" Style="{StaticResource CardTitleStyle}" Foreground="#4CAF50"/>
                            <TextBlock Text="{x:Bind ViewModel.ResultMessage, Mode=OneWay}" Style="{StaticResource CardSubtitleStyle}"/>
                            <TextBlock Text="{x:Bind ViewModel.ResultPath, Mode=OneWay}" Style="{StaticResource CardSubtitleStyle}" TextTrimming="CharacterEllipsis" Opacity="0.6"/>
                        </StackPanel>

                        <Button Grid.Column="2" Command="{x:Bind ViewModel.OpenOutputFolderCommand}" Style="{StaticResource OutlinedButtonStyle}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE838;" FontSize="14"/>
                                <TextBlock Text="OPEN FOLDER"/>
                            </StackPanel>
                        </Button>
                    </Grid>
                </Border>

                <!-- Action Status -->
                <Border Background="{x:Bind ViewModel.ActionStatusColor, Mode=OneWay, Converter={StaticResource StringToBrushConverter}}"
                        CornerRadius="8" Padding="16"
                        Visibility="{x:Bind ViewModel.HasActionStatus, Mode=OneWay}" Opacity="0.9">
                    <TextBlock Text="{x:Bind ViewModel.ActionStatus, Mode=OneWay}" Foreground="White" FontWeight="SemiBold"/>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
