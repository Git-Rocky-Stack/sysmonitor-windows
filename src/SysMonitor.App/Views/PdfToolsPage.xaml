<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SysMonitor.App.Views.PdfToolsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SysMonitor.App.Views"
    xmlns:vm="using:SysMonitor.App.ViewModels"
    x:Name="ContentArea"
    Background="Transparent">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Padding="24" Spacing="16">
            <!-- Header -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="PDF Tools" FontSize="28" FontWeight="SemiBold" Foreground="White"/>
                    <TextBlock Text="Merge, split, extract, sign and convert files to PDF" FontSize="14" Foreground="#808080" Margin="0,4,0,0"/>
                </StackPanel>
            </Grid>

            <!-- Mode Selection -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="16" BorderBrush="#1A1A1A" BorderThickness="1">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <RadioButton Content="Merge PDFs" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsMergeMode, Mode=TwoWay}"
                                 Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Merge"/>
                    <RadioButton Content="Split PDF" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsSplitMode, Mode=TwoWay}"
                                 Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Split" Margin="16,0,0,0"/>
                    <RadioButton Content="Extract Pages" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsExtractMode, Mode=TwoWay}"
                                 Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Extract" Margin="16,0,0,0"/>
                    <RadioButton Content="Add Signature" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsSignatureMode, Mode=TwoWay}"
                                 Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Signature" Margin="16,0,0,0"/>
                    <RadioButton Content="Convert to PDF" GroupName="Mode" IsChecked="{x:Bind ViewModel.IsConvertMode, Mode=TwoWay}"
                                 Command="{x:Bind ViewModel.SetModeCommand}" CommandParameter="Convert" Margin="16,0,0,0"/>
                </StackPanel>
            </Border>

            <!-- Merge Mode -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsMergeMode, Mode=OneWay}">
                <StackPanel Spacing="16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="PDFs to Merge" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                            <Button Command="{x:Bind ViewModel.SelectMultiplePdfsCommand}">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE710;" FontSize="14"/>
                                    <TextBlock Text="Add PDFs"/>
                                </StackPanel>
                            </Button>
                            <Button Command="{x:Bind ViewModel.ClearFilesCommand}">
                                <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                            </Button>
                        </StackPanel>
                    </Grid>

                    <ListView ItemsSource="{x:Bind ViewModel.SelectedFiles, Mode=OneWay}" MinHeight="150"
                              Background="Transparent" SelectionMode="None">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="vm:PdfFileDisplay">
                                <Border Background="#141414" CornerRadius="6" Padding="12" Margin="0,2">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <FontIcon Glyph="&#xEA90;" Foreground="#F44336" FontSize="24" VerticalAlignment="Center"/>

                                        <StackPanel Grid.Column="1" Margin="12,0" VerticalAlignment="Center">
                                            <TextBlock Text="{x:Bind FileName}" FontSize="13" Foreground="White"/>
                                            <TextBlock FontSize="11" Foreground="#606060">
                                                <Run Text="{x:Bind PageCount}"/> pages - <Run Text="{x:Bind FileSize}"/>
                                            </TextBlock>
                                        </StackPanel>

                                        <Button Grid.Column="2" Command="{Binding DataContext.MoveFileUpCommand, ElementName=ContentArea}"
                                                CommandParameter="{x:Bind}" Padding="8" Background="Transparent" Margin="4,0">
                                            <FontIcon Glyph="&#xE74A;" FontSize="12"/>
                                        </Button>
                                        <Button Grid.Column="3" Command="{Binding DataContext.RemoveFileCommand, ElementName=ContentArea}"
                                                CommandParameter="{x:Bind}" Padding="8" Background="Transparent">
                                            <FontIcon Glyph="&#xE711;" FontSize="12"/>
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <Button Command="{x:Bind ViewModel.MergePdfsCommand}" Style="{StaticResource AccentButtonStyle}"
                            HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.IsProcessing, Mode=OneWay, Converter={StaticResource InverseBoolConverter}}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8BB;" FontSize="14"/>
                            <TextBlock Text="Merge PDFs"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Split/Extract/Signature Mode - File Selection -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsMergeMode, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}">
                <StackPanel Spacing="16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Select PDF File" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                        <Button Grid.Column="1" Command="{x:Bind ViewModel.SelectPdfCommand}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8E5;" FontSize="14"/>
                                <TextBlock Text="Browse"/>
                            </StackPanel>
                        </Button>
                    </Grid>

                    <!-- Selected File Info -->
                    <Border Background="#141414" CornerRadius="6" Padding="16" Visibility="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <FontIcon Glyph="&#xEA90;" Foreground="#F44336" FontSize="32" VerticalAlignment="Center"/>

                            <StackPanel Grid.Column="1" Margin="16,0,0,0">
                                <TextBlock Text="{x:Bind ViewModel.SelectedPdfName, Mode=OneWay}" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                <StackPanel Orientation="Horizontal" Spacing="16" Margin="0,4,0,0">
                                    <TextBlock FontSize="12" Foreground="#808080">
                                        <Run Text="{x:Bind ViewModel.PageCount, Mode=OneWay}"/> pages
                                    </TextBlock>
                                    <TextBlock Text="{x:Bind ViewModel.FileSize, Mode=OneWay}" FontSize="12" Foreground="#808080"/>
                                    <TextBlock Text="{x:Bind ViewModel.PdfVersion, Mode=OneWay}" FontSize="12" Foreground="#808080"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Split Options -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsSplitMode, Mode=OneWay}">
                <StackPanel Spacing="16">
                    <TextBlock Text="Split Options" FontSize="16" FontWeight="SemiBold" Foreground="White"/>

                    <RadioButton Content="Split into individual pages" IsChecked="{x:Bind ViewModel.SplitAllPages, Mode=TwoWay}"/>
                    <RadioButton Content="Split by page range" IsChecked="{x:Bind ViewModel.SplitByRange, Mode=TwoWay}" Margin="0,8,0,0"/>

                    <Grid Visibility="{x:Bind ViewModel.SplitByRange, Mode=OneWay}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="From page:" VerticalAlignment="Center" Foreground="#808080"/>
                        <NumberBox Grid.Column="1" Value="{x:Bind ViewModel.SplitStartPage, Mode=TwoWay}" Minimum="1"
                                   Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                        <TextBlock Grid.Column="2" Text="To page:" VerticalAlignment="Center" Foreground="#808080" Margin="16,0,0,0"/>
                        <NumberBox Grid.Column="3" Value="{x:Bind ViewModel.SplitEndPage, Mode=TwoWay}" Minimum="1"
                                   Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                    </Grid>

                    <Button Command="{x:Bind ViewModel.SplitPdfCommand}" Style="{StaticResource AccentButtonStyle}"
                            HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8C8;" FontSize="14"/>
                            <TextBlock Text="Split PDF"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Extract Options -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsExtractMode, Mode=OneWay}">
                <StackPanel Spacing="16">
                    <TextBlock Text="Extract Pages" FontSize="16" FontWeight="SemiBold" Foreground="White"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="From page:" VerticalAlignment="Center" Foreground="#808080"/>
                        <NumberBox Grid.Column="1" Value="{x:Bind ViewModel.ExtractStartPage, Mode=TwoWay}" Minimum="1"
                                   Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                        <TextBlock Grid.Column="2" Text="To page:" VerticalAlignment="Center" Foreground="#808080" Margin="16,0,0,0"/>
                        <NumberBox Grid.Column="3" Value="{x:Bind ViewModel.ExtractEndPage, Mode=TwoWay}" Minimum="1"
                                   Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                    </Grid>

                    <Button Command="{x:Bind ViewModel.ExtractPagesCommand}" Style="{StaticResource AccentButtonStyle}"
                            HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8A7;" FontSize="14"/>
                            <TextBlock Text="Extract Pages"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Signature Options -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsSignatureMode, Mode=OneWay}">
                <StackPanel Spacing="16">
                    <TextBlock Text="Add Signature" FontSize="16" FontWeight="SemiBold" Foreground="White"/>

                    <!-- Signature Type Selection -->
                    <StackPanel Orientation="Horizontal" Spacing="16">
                        <RadioButton Content="Draw Signature" GroupName="SignatureType"
                                     IsChecked="{x:Bind ViewModel.IsDrawSignature, Mode=TwoWay}"/>
                        <RadioButton Content="Type Signature" GroupName="SignatureType"
                                     IsChecked="{x:Bind ViewModel.IsTypeSignature, Mode=TwoWay}"/>
                        <RadioButton Content="Upload Image" GroupName="SignatureType"
                                     IsChecked="{x:Bind ViewModel.IsUploadSignature, Mode=TwoWay}"/>
                    </StackPanel>

                    <!-- Draw Signature Canvas -->
                    <StackPanel Spacing="8" Visibility="{x:Bind ViewModel.IsDrawSignature, Mode=OneWay}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Draw your signature below" FontSize="13" Foreground="#808080"/>
                            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                                <Button Click="ClearInkCanvas_Click" ToolTipService.ToolTip="Clear Canvas">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <FontIcon Glyph="&#xE74D;" FontSize="12"/>
                                        <TextBlock Text="Clear"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </Grid>
                        <Border Background="White" CornerRadius="6" Height="150" BorderBrush="#303030" BorderThickness="1"
                                Padding="0">
                            <Canvas x:Name="SignatureCanvas"
                                    Background="White"
                                    PointerPressed="SignatureCanvas_PointerPressed"
                                    PointerMoved="SignatureCanvas_PointerMoved"
                                    PointerReleased="SignatureCanvas_PointerReleased"
                                    PointerExited="SignatureCanvas_PointerReleased"/>
                        </Border>
                        <TextBlock Text="Use mouse or touch to draw" FontSize="11" Foreground="#606060" FontStyle="Italic"/>
                    </StackPanel>

                    <!-- Type Signature (Cursive) -->
                    <StackPanel Spacing="8" Visibility="{x:Bind ViewModel.IsTypeSignature, Mode=OneWay}">
                        <TextBlock Text="Type your name below (will appear in cursive style)" FontSize="13" Foreground="#808080"/>
                        <TextBox x:Name="TypedSignatureInput"
                                 Text="{x:Bind ViewModel.TypedSignatureName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 PlaceholderText="Type your full name..."
                                 FontSize="16"
                                 TextChanged="TypedSignatureInput_TextChanged"/>
                        <Border Background="White" CornerRadius="6" Height="80" BorderBrush="#303030" BorderThickness="1" Padding="16,8">
                            <TextBlock x:Name="TypedSignaturePreview"
                                       Text="{x:Bind ViewModel.TypedSignatureName, Mode=OneWay}"
                                       FontFamily="Segoe Script"
                                       FontSize="32"
                                       Foreground="Black"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left"/>
                        </Border>
                        <TextBlock Text="Preview of your signature in cursive style" FontSize="11" Foreground="#606060" FontStyle="Italic"/>
                    </StackPanel>

                    <!-- Upload Signature Image -->
                    <StackPanel Spacing="8" Visibility="{x:Bind ViewModel.IsUploadSignature, Mode=OneWay}">
                        <TextBlock Text="Signature Image" FontSize="13" Foreground="#808080"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Background="#141414" CornerRadius="6" Padding="12,8" VerticalAlignment="Center">
                                <TextBlock Text="{x:Bind ViewModel.SignatureImageName, Mode=OneWay}" Foreground="#808080"
                                           VerticalAlignment="Center"/>
                            </Border>
                            <Button Grid.Column="1" Command="{x:Bind ViewModel.SelectSignatureImageCommand}" Margin="8,0">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE8B9;" FontSize="14"/>
                                    <TextBlock Text="Browse"/>
                                </StackPanel>
                            </Button>
                            <Button Grid.Column="2" Command="{x:Bind ViewModel.ClearSignatureImageCommand}"
                                    Visibility="{x:Bind ViewModel.HasSignatureImage, Mode=OneWay}">
                                <FontIcon Glyph="&#xE711;" FontSize="14"/>
                            </Button>
                        </Grid>
                    </StackPanel>

                    <!-- Signer Name -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Signer Name" FontSize="13" Foreground="#808080"/>
                        <TextBox Text="{x:Bind ViewModel.SignerName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 PlaceholderText="Enter your name (appears below signature)"/>
                    </StackPanel>

                    <!-- Include Date -->
                    <CheckBox Content="Include date" IsChecked="{x:Bind ViewModel.IncludeSignatureDate, Mode=TwoWay}"/>

                    <!-- Page Number -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Page:" VerticalAlignment="Center" Foreground="#808080"/>
                        <NumberBox Grid.Column="1" Value="{x:Bind ViewModel.SignaturePageNumber, Mode=TwoWay}" Minimum="1"
                                   Maximum="{x:Bind ViewModel.PageCount, Mode=OneWay}" SpinButtonPlacementMode="Compact" Margin="8,0"/>
                    </Grid>

                    <!-- Position Controls -->
                    <TextBlock Text="Signature Position" FontSize="13" Foreground="#808080" Margin="0,8,0,0"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="X:" VerticalAlignment="Center" Foreground="#808080"/>
                        <Slider Grid.Column="1" Value="{x:Bind ViewModel.SignatureX, Mode=TwoWay}" Minimum="0" Maximum="100" Margin="8,0"/>
                        <TextBlock Grid.Column="2" VerticalAlignment="Center" Foreground="#606060">
                            <Run Text="{x:Bind ViewModel.SignatureX, Mode=OneWay}"/><Run Text="%"/>
                        </TextBlock>
                        <TextBlock Grid.Column="3" Text="Y:" VerticalAlignment="Center" Foreground="#808080" Margin="16,0,0,0"/>
                        <Slider Grid.Column="4" Value="{x:Bind ViewModel.SignatureY, Mode=TwoWay}" Minimum="0" Maximum="100" Margin="8,0"/>
                        <TextBlock Grid.Column="5" VerticalAlignment="Center" Foreground="#606060">
                            <Run Text="{x:Bind ViewModel.SignatureY, Mode=OneWay}"/><Run Text="%"/>
                        </TextBlock>
                    </Grid>

                    <!-- Signature Width -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Width:" VerticalAlignment="Center" Foreground="#808080"/>
                        <Slider Grid.Column="1" Value="{x:Bind ViewModel.SignatureWidth, Mode=TwoWay}" Minimum="50" Maximum="300" Margin="8,0"/>
                        <TextBlock Grid.Column="2" VerticalAlignment="Center" Foreground="#606060">
                            <Run Text="{x:Bind ViewModel.SignatureWidth, Mode=OneWay}"/><Run Text="pt"/>
                        </TextBlock>
                    </Grid>

                    <Button Command="{x:Bind ViewModel.ApplySignatureCommand}" Style="{StaticResource AccentButtonStyle}"
                            HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasPdfSelected, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xED64;" FontSize="14"/>
                            <TextBlock Text="Apply Signature"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Convert to PDF Mode -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsConvertMode, Mode=OneWay}">
                <StackPanel Spacing="16">
                    <TextBlock Text="Convert File to PDF" FontSize="16" FontWeight="SemiBold" Foreground="White"/>

                    <!-- Supported formats info -->
                    <Border Background="#141414" CornerRadius="6" Padding="12">
                        <StackPanel>
                            <TextBlock Text="Supported file formats:" FontSize="12" Foreground="#808080"/>
                            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,4,0,0">
                                <Border Background="#1A3A1A" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="Images" FontSize="11" Foreground="#4CAF50"/>
                                </Border>
                                <TextBlock Text="JPG, PNG, BMP, GIF, TIFF" FontSize="12" Foreground="#606060" VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,4,0,0">
                                <Border Background="#1A2A3A" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="Text" FontSize="11" Foreground="#2196F3"/>
                                </Border>
                                <TextBlock Text="TXT" FontSize="12" Foreground="#606060" VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- File Selection -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Border Background="#141414" CornerRadius="6" Padding="12,8" VerticalAlignment="Center">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8A5;" FontSize="16" Foreground="#808080"
                                          Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}"/>
                                <FontIcon Glyph="&#xE8FB;" FontSize="16" Foreground="#4CAF50"
                                          Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}"/>
                                <StackPanel>
                                    <TextBlock Text="{x:Bind ViewModel.ConvertFileName, Mode=OneWay}"
                                               Foreground="White" FontWeight="SemiBold"
                                               Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}"/>
                                    <TextBlock Text="No file selected"
                                               Foreground="#606060"
                                               Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay, Converter={StaticResource InvertBoolToVisibilityConverter}}"/>
                                    <TextBlock Text="{x:Bind ViewModel.ConvertFileType, Mode=OneWay}"
                                               Foreground="#808080" FontSize="11"
                                               Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        <Button Grid.Column="1" Command="{x:Bind ViewModel.SelectConvertFileCommand}" Margin="8,0">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8E5;" FontSize="14"/>
                                <TextBlock Text="Browse"/>
                            </StackPanel>
                        </Button>
                        <Button Grid.Column="2" Command="{x:Bind ViewModel.ClearConvertFileCommand}"
                                Visibility="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}">
                            <FontIcon Glyph="&#xE711;" FontSize="14"/>
                        </Button>
                    </Grid>

                    <Button Command="{x:Bind ViewModel.ConvertToPdfCommand}" Style="{StaticResource AccentButtonStyle}"
                            HorizontalAlignment="Stretch" IsEnabled="{x:Bind ViewModel.HasConvertFile, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8AB;" FontSize="14"/>
                            <TextBlock Text="Convert to PDF"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Processing Status -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="16" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsProcessing, Mode=OneWay}">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <ProgressRing IsActive="True" Width="20" Height="20"/>
                    <TextBlock Text="{x:Bind ViewModel.ProcessingStatus, Mode=OneWay}" Foreground="#808080" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Result -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.HasResult, Mode=OneWay}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel>
                        <TextBlock Text="Operation Complete" FontSize="16" FontWeight="SemiBold" Foreground="#4CAF50"/>
                        <TextBlock Text="{x:Bind ViewModel.ResultMessage, Mode=OneWay}" FontSize="13" Foreground="#808080" Margin="0,4,0,0"/>
                        <TextBlock Text="{x:Bind ViewModel.ResultPath, Mode=OneWay}" FontSize="11" Foreground="#606060" Margin="0,4,0,0" TextTrimming="CharacterEllipsis"/>
                    </StackPanel>

                    <Button Grid.Column="1" Command="{x:Bind ViewModel.OpenOutputFolderCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE838;" FontSize="14"/>
                            <TextBlock Text="Open Folder"/>
                        </StackPanel>
                    </Button>
                </Grid>
            </Border>

            <!-- Action Status -->
            <Border Background="{x:Bind ViewModel.ActionStatusColor, Mode=OneWay, Converter={StaticResource StringToBrushConverter}}" CornerRadius="8" Padding="16"
                    Visibility="{x:Bind ViewModel.HasActionStatus, Mode=OneWay}" Opacity="0.9">
                <TextBlock Text="{x:Bind ViewModel.ActionStatus, Mode=OneWay}" Foreground="White" FontWeight="SemiBold"/>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
