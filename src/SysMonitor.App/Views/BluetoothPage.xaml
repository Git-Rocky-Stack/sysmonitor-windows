<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SysMonitor.App.Views.BluetoothPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SysMonitor.App.Views"
    xmlns:utils="using:SysMonitor.Core.Services.Utilities"
    Background="Transparent">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Padding="24" Spacing="16">
            <!-- Header -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="Bluetooth Analyzer" FontSize="28" FontWeight="SemiBold" Foreground="White"/>
                    <TextBlock Text="Scan and analyze Bluetooth devices" FontSize="14" Foreground="#808080" Margin="0,4,0,0"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button Command="{x:Bind ViewModel.ScanDevicesCommand}" IsEnabled="{x:Bind ViewModel.IsAvailable, Mode=OneWay}"
                            Style="{StaticResource AccentButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE72C;" FontSize="14"/>
                            <TextBlock Text="Scan Devices"/>
                        </StackPanel>
                    </Button>
                    <Button Command="{x:Bind ViewModel.StopScanCommand}" Visibility="{x:Bind ViewModel.IsScanning, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE71A;" FontSize="14"/>
                            <TextBlock Text="Stop"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Adapter Info Card -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel>
                        <TextBlock Text="Bluetooth Adapter" FontSize="12" Foreground="#808080"/>
                        <TextBlock Text="{x:Bind ViewModel.AdapterName, Mode=OneWay}" FontSize="20" FontWeight="SemiBold" Foreground="White" Margin="0,4,0,0"/>
                        <TextBlock Text="{x:Bind ViewModel.AdapterAddress, Mode=OneWay}" FontSize="12" Foreground="#808080" Margin="0,4,0,0"/>
                    </StackPanel>
                    <Border Grid.Column="1" Background="{x:Bind ViewModel.AdapterStatusColor, Mode=OneWay}" CornerRadius="4" Padding="12,6" VerticalAlignment="Center">
                        <TextBlock Text="{x:Bind ViewModel.AdapterStatus, Mode=OneWay}" FontSize="12" FontWeight="SemiBold" Foreground="White"/>
                    </Border>
                </Grid>
            </Border>

            <!-- Stats Cards -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Devices Found -->
                <Border Background="#0A0A0A" CornerRadius="8" Padding="20" Margin="0,0,8,0" BorderBrush="#1A1A1A" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Devices Found" FontSize="12" Foreground="#808080"/>
                        <TextBlock Text="{x:Bind ViewModel.DevicesFound, Mode=OneWay}" FontSize="32" FontWeight="Bold" Foreground="#00BCD4" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Connected -->
                <Border Grid.Column="1" Background="#0A0A0A" CornerRadius="8" Padding="20" Margin="4,0" BorderBrush="#1A1A1A" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Connected" FontSize="12" Foreground="#808080"/>
                        <TextBlock Text="{x:Bind ViewModel.ConnectedDevices, Mode=OneWay}" FontSize="32" FontWeight="Bold" Foreground="#4CAF50" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Paired -->
                <Border Grid.Column="2" Background="#0A0A0A" CornerRadius="8" Padding="20" Margin="8,0,0,0" BorderBrush="#1A1A1A" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="Paired" FontSize="12" Foreground="#808080"/>
                        <TextBlock Text="{x:Bind ViewModel.PairedDevices, Mode=OneWay}" FontSize="32" FontWeight="Bold" Foreground="#9C27B0" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Scan Status -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="16" BorderBrush="#1A1A1A" BorderThickness="1"
                    Visibility="{x:Bind ViewModel.IsScanning, Mode=OneWay}">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <ProgressRing IsActive="True" Width="20" Height="20"/>
                    <TextBlock Text="{x:Bind ViewModel.ScanStatus, Mode=OneWay}" Foreground="#808080" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Devices List -->
            <Border Background="#0A0A0A" CornerRadius="8" Padding="20" BorderBrush="#1A1A1A" BorderThickness="1" MinHeight="300">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Discovered Devices" FontSize="16" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,16"/>

                    <ListView Grid.Row="1" ItemsSource="{x:Bind ViewModel.Devices, Mode=OneWay}"
                              Background="Transparent" SelectionMode="None">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="utils:BluetoothDeviceInfo">
                                <Border Background="#141414" CornerRadius="6" Padding="16" Margin="0,4">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Icon -->
                                        <Border Background="#1A1A1A" CornerRadius="8" Width="48" Height="48" VerticalAlignment="Center">
                                            <FontIcon Glyph="{x:Bind DeviceIcon}" Foreground="{x:Bind DeviceTypeColor}" FontSize="20"/>
                                        </Border>

                                        <!-- Device Info -->
                                        <StackPanel Grid.Column="1" Margin="16,0" VerticalAlignment="Center">
                                            <TextBlock Text="{x:Bind Name}" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <TextBlock Text="{x:Bind DeviceType}" FontSize="12" Foreground="#808080" Margin="0,2,0,0"/>
                                            <TextBlock Text="{x:Bind Address}" FontSize="11" Foreground="#606060" Margin="0,2,0,0"/>
                                        </StackPanel>

                                        <!-- Signal -->
                                        <StackPanel Grid.Column="2" Margin="16,0" VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <TextBlock Text="Signal" FontSize="11" Foreground="#606060" HorizontalAlignment="Center"/>
                                            <TextBlock FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,2,0,0"
                                                       Foreground="{x:Bind SignalColor}">
                                                <Run Text="{x:Bind SignalStrength}"/><Run Text="%"/>
                                            </TextBlock>
                                        </StackPanel>

                                        <!-- Status -->
                                        <StackPanel Grid.Column="3" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                            <Border Background="{x:Bind StatusColor}" CornerRadius="4" Padding="8,4"
                                                    Visibility="{x:Bind IsConnected}">
                                                <TextBlock Text="Connected" FontSize="11" Foreground="White"/>
                                            </Border>
                                            <Border Background="#FF9800" CornerRadius="4" Padding="8,4"
                                                    Visibility="{x:Bind IsPaired}">
                                                <TextBlock Text="Paired" FontSize="11" Foreground="White"/>
                                            </Border>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <!-- Empty State -->
                    <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center"
                                Visibility="{x:Bind ViewModel.DevicesFound, Mode=OneWay, Converter={StaticResource ZeroToVisibilityConverter}}">
                        <FontIcon Glyph="&#xE702;" FontSize="48" Foreground="#404040"/>
                        <TextBlock Text="No Bluetooth devices found" FontSize="14" Foreground="#606060" Margin="0,12,0,0"/>
                        <TextBlock Text="Click 'Scan Devices' to search for nearby devices" FontSize="12" Foreground="#404040" Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>
